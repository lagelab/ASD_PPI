<!-- badges: start -->
[![DOI](https://zenodo.org/badge/490042485.svg)](https://zenodo.org/badge/latestdoi/490042485)
<!-- badges: end -->

# ASD_PPI
Documentation for analysis scripts used in the ASD PPI paper:

Pintacuda G*, Hsu YH*, Tsafou K, Li KW, Martín JM, Riseman J, Biagini JC, Ching JKT, Mena D, Gonzalez-Lozano MA, Egri SB, Jaffe J, Smit AB, Fornelos N, Eggan KC, Lage K. [Protein interaction studies in human induced neurons indicate convergent biology underlying autism spectrum disorders](https://doi.org/10.1016/j.xgen.2022.100250). Cell Genomics (2023).

## File descriptions

| Analysis                                       | Script (in ASD_PPI/scripts)                    | Input (in ASD_PPI/data, unless indicated otherwise)                                                                                                                                                                                                                             | Output (in ASD_PPI/output, unless indicated otherwise)                  | Paper figures/tables |
| ---------------------------------------------- | ---------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- | -------------------- |
| RNA-seq data analysis                          | RNA/ASD_RNA_1_TrimGalore.sh                    | scripts/RNA/ASD_RNA_1_TrimGalore.param                                                                                                                                                                                                                                          | (reformatted: data/ASD_RNAseq_geneCounts_noTail.tsv)                    |                      |
|                                                | RNA/ASD_RNA_2_Hisat2.sh                        | scripts/RNA/ASD_RNA_2_Hisat2.param                                                                                                                                                                                                                                              |                                                                         |                      |
|                                                | RNA/ASD_RNA_3_Htseq-count.sh                   | (raw FASTQ files deposited to GEO: [GSE178896](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE178896))                                                                                                                                                                   |                                                                         |                      |
|                                                |                                                | (HISAT2 index files [genome with transcripts] downloaded from [here](https://genome-idx.s3.amazonaws.com/hisat/grch38_tran.tar.gz))                                                                                                                                             |                                                                         |                      |
|                                                |                                                | (GTF file downloaded from here)                                                                                                                                                                                                                                                 |                                                                         |                      |
|                                                | ASD_plotRnaHeatMap.r                           | ASD_RNAseq_geneCounts_noTail.tsv                                                                                                                                                                                                                                                | ASD_RNA_geneAvgLcpm.txt                                                 |                      |
|                                                |                                                | Homo_sapiens.GRCh38.84.GeneAnnotations.txt                                                                                                                                                                                                                                      | ASD_RNA_SatterstromHeatMap.pdf                                          | Fig 1C               |
|                                                |                                                | Nehme2018_MarkerGenes.txt                                                                                                                                                                                                                                                       | ASD_RNA_MarkerGenesHeatMap.pdf                                          | Fig S1A              |
| Generating scRNA-seq t-SNE plots               | ASD_seuratPlots_Velmeshev2019.r                | (exprMatrix.tsv.gz downloaded from [here](https://cells.ucsc.edu/?ds=autism))                                                                                                                                                                                                   | ASD_Velmeshev2019_DimPlot.png                                           | Fig S1B              |
|                                                |                                                | (meta.tsv downloaded from [here](https://cells.ucsc.edu/?ds=autism))                                                                                                                                                                                                            | ASD_Velmeshev2019_BaitFeaturePlots.png                                  | Fig S1C              |
|                                                |                                                | (tSNE.coords.tsv.gz downloaded from [here](https://cells.ucsc.edu/?ds=autism))                                                                                                                                                                                                  |                                                                         |                      |
| Generating IP-MS volcano and scatter plots     | ASD_plotVolcanoAndScatter.r                    | ASD_GenoppiResults.xlsx                                                                                                                                                                                                                                                         | ASD_Scatter_InWebVolcanos_13IPs.pdf                                     | Fig 2A,B, S2         |
|                                                |                                                |                                                                                                                                                                                                                                                                                 | ASD_ANK2_PTEN_DYRK1A_Volcanos.pdf                                       | Fig 4B, 5A, 6D       |
| Comparison of IP-MS data across sites          | ASD_plotSiteSummaryStats.r                     | ASD_IpSummaryStats.txt                                                                                                                                                                                                                                                          | ASD_SiteSummaryStats_BoxPlots.pdf                                       | Fig S3A              |
|                                                |                                                | ASD_IpComparisonStats.txt                                                                                                                                                                                                                                                       | ASD_IpPairsBySite_BoxPlots.pdf                                          | Fig S3B              |
| Co-expression analysis                         | ASD_calcCoExp_Sitckels2021.py                  | Homo_sapiens.GRCh38.84.GeneAnnotations.txt                                                                                                                                                                                                                                      | (filtered: data/CoExp/Stickels2021_ASD-Baits_CoExpFisherNegLogP.txt.gz) |                      |
|                                                |                                                | HOM_MouseHumanSequence.rpt.txt                                                                                                                                                                                                                                                  |                                                                         |                      |
|                                                |                                                | (Puck_190921_19.digital_expression.txt.gz downloaded from [here](https://singlecell.broadinstitute.org/single_cell/data/public/SCP815/highly-sensitive-spatial-transcriptomics-at-near-cellular-resolution-with-slide-seqv2?filename=Puck_190921_19.digital_expression.txt.gz)) |                                                                         |                      |
|                                                | ASD_calcCoExp_Maynard2021.py                   | (counts matrix and metadata downloaded from [spatialLIBD R package](https://github.com/LieberInstitute/HumanPilot))                                                                                                                                                             | (filtered: data/CoExp/Maynard2021_ASD-Baits_CoExpFisherNegLogP.txt.gz)  |                      |
|                                                | ASD_calcCoExp_Velmeshev2019.r                  | Homo_sapiens.GRCh38.84.GeneAnnotations.txt                                                                                                                                                                                                                                      | (filtered: data/CoExp/Velmeshev2019_ASD-Baits_CoExpPropRho.txt.gz)      |                      |
|                                                |                                                | (rawMatrix.zip downloaded from [here](https://cells.ucsc.edu/?ds=autism))                                                                                                                                                                                                       |                                                                         |                      |
|                                                | ASD_calcCoExp_BrainSpan.r                      | Homo_sapiens.GRCh38.84.GeneAnnotations.txt                                                                                                                                                                                                                                      | (filtered: data/CoExp/BrainSpan_ASD-Baits_CoExpPropRho.txt.gz)          |                      |
|                                                |                                                | ("RNA-Seq Gencode v10 summarized to genes" data downloaded from [here](https://www.brainspan.org/api/v2/well_known_file_download/267666525))                                                                                                                                    |                                                                         |                      |
|                                                | ASD_plotCoExp_IntSubsets.r                     | ASD_IntSubsetTable.txt                                                                                                                                                                                                                                                          | ASD_CoExp_IntSubsets_ViolinPlots.pdf                                    | Fig S3D,E            |
|                                                |                                                | CoExp/Stickels2021_ASD-Baits_CoExpFisherNegLogP.txt.gz                                                                                                                                                                                                                          | ASD_CoExp_IntSubsets-Sites_ViolinPlots.pdf                              | Fig S3C              |
|                                                |                                                | CoExp/Maynard2021_ASD-Baits_CoExpFisherNegLogP.txt.gz                                                                                                                                                                                                                           |                                                                         |                      |
|                                                |                                                | CoExp/Velmeshev2019_ASD-Baits_CoExpPropRho.txt.gz                                                                                                                                                                                                                               |                                                                         |                      |
|                                                |                                                | CoExp/BrainSpan_ASD-Baits_CoExpPropRho.txt.gz                                                                                                                                                                                                                                   |                                                                         |                      |
|                                                | ASD_plotCoExp_IntsVsOthers.r                   | ASD_MasterInteractorTable.txt                                                                                                                                                                                                                                                   | ASD_CoExp_ViolinPlots.pdf                                               | Fig S8C              |
|                                                |                                                | CoExp/Stickels2021_ASD-Baits_CoExpFisherNegLogP.txt.gz                                                                                                                                                                                                                          | ASD_CoExp-Maynard2021_ViolinPlot.pdf                                    | Fig 2H               |
|                                                |                                                | CoExp/Maynard2021_ASD-Baits_CoExpFisherNegLogP.txt.gz                                                                                                                                                                                                                           |                                                                         |                      |
|                                                |                                                | CoExp/Velmeshev2019_ASD-Baits_CoExpPropRho.txt.gz                                                                                                                                                                                                                               |                                                                         |                      |
|                                                |                                                | CoExp/BrainSpan_ASD-Baits_CoExpPropRho.txt.gz                                                                                                                                                                                                                                   |                                                                         |                      |
| Generating network plot and pie charts         | ASD_plotNetwork.r                              | ASD_MasterInteractorTable.txt                                                                                                                                                                                                                                                   | ASD_NetworkPlot.pdf                                                     | Fig 2C               |
|                                                |                                                |                                                                                                                                                                                                                                                                                 | ASD_NetowrkPieCharts.pdf                                                | Fig 2D,E             |
| Comparison of iN vs. brain IP-MS data          | ASD_iNvsBrainComparison.r                      | ASD_MasterInteractorTable.txt                                                                                                                                                                                                                                                   | ASD_BrainVolcanos_iNoverlay.pdf                                         | Fig S7B              |
|                                                |                                                | ASD_IntSubsetTable.txt                                                                                                                                                                                                                                                          | ASD_iNvsBrain_OverlapEnrichment.txt                                     | Fig 2G, S7C, Data S2 |
|                                                |                                                | ASD_GenoppiResults.xlsx                                                                                                                                                                                                                                                         |                                                                         |                      |
|                                                |                                                | BrainIPs_Filtered/SCN2A.pep1.bait2.FilteredNonInts.txt                                                                                                                                                                                                                          |                                                                         |                      |
|                                                |                                                | BrainIPs_Filtered/SHANK3.pep1.bait2.FilteredNonInts.txt                                                                                                                                                                                                                         |                                                                         |                      |
|                                                |                                                | BrainIPs_Filtered/SYNGAP1.pep1.bait2.FilteredNonInts.txt                                                                                                                                                                                                                        |                                                                         |                      |
| BrainSpan analysis                             | ASD_BrainSpanAnalysis.r                        | BrainSpan/array_expression_matrix.processed.csv                                                                                                                                                                                                                                 | ASD_SatterstromOverlap_BrainSpanPlot.pdf                                | Fig S11D             |
|                                                |                                                | BrainSpan/rows_metadata.filtered.csv                                                                                                                                                                                                                                            | ASD_BrainSpanPlots.pdf                                                  | Fig S8A,B            |
|                                                |                                                | BrainSpan/columns_metadata.csv                                                                                                                                                                                                                                                  |                                                                         |                      |
|                                                |                                                | BrainSpan/age.mapping.csv                                                                                                                                                                                                                                                       |                                                                         |                      |
|                                                |                                                | Satterstrom2020_TableS2_Autosomal.txt                                                                                                                                                                                                                                           |                                                                         |                      |
|                                                |                                                | ASD_MasterInteractorTable.txt                                                                                                                                                                                                                                                   |                                                                         |                      |
|                                                |                                                | BrainSpan/ASD_iN_brain_BrainSpanValues.tsv                                                                                                                                                                                                                                      |                                                                         |                      |
| Tissue enrichment analysis                     | ASD_GtexEnrichmentAnalysis.r                   | ASD_MasterInteractorTable_withInWeb.txt                                                                                                                                                                                                                                         | ASD_GtexEnrichment.txt                                                  | Table S6             |
|                                                |                                                | Homo_sapiens.GRCh38.84.GeneAnnotations.txt                                                                                                                                                                                                                                      | ASD_GtexEnrichment_BarPlots.pdf                                         | Fig 3A,B, S8D        |
|                                                |                                                | GTEx/GTEx.tstat.tsv                                                                                                                                                                                                                                                             |                                                                         |                      |
|                                                |                                                | GTEx/GTEx.tissue.names.tsv                                                                                                                                                                                                                                                      |                                                                         |                      |
|                                                |                                                | GTEx/GTEx_brain.tstat.tsv                                                                                                                                                                                                                                                       |                                                                         |                      |
|                                                |                                                | GTEx/GTEx_brain.tissue.names.tsv                                                                                                                                                                                                                                                |                                                                         |                      |
| Cell type enrichment analysis                  | ASD_calcPercExp_Velmeshev2019.py               | (exprMatrix.tsv.gz downloaded from [here](https://cells.ucsc.edu/?ds=autism))                                                                                                                                                                                                   | data/Velmeshev2019_PercExpMatrix.txt.gz                                 |                      |
|                                                |                                                | (meta.tsv downloaded from [here](https://cells.ucsc.edu/?ds=autism))                                                                                                                                                                                                            |                                                                         |                      |
|                                                | ASD_CellTypeEnrichmentAnalysis.py              | Velmeshev2019_genes.tsv                                                                                                                                                                                                                                                         | ASD_scExpEnrichment.txt                                                 | Table S6             |
|                                                |                                                | ASD_MasterInteractorTable.txt                                                                                                                                                                                                                                                   | ASD_scDegEnrichment.txt                                                 | Table S6             |
|                                                |                                                | Velmeshev2019_PercExpMatrix.txt.gz                                                                                                                                                                                                                                              |                                                                         |                      |
|                                                |                                                | Velmeshev2019_DataS4.xls                                                                                                                                                                                                                                                        |                                                                         |                      |
|                                                | ASD_plotCellTypeEnrichment.r                   | output/ASD_scExpEnrichment.txt                                                                                                                                                                                                                                                  | ASD_CellTypeEnrichment_FacetBarPlots.pdf                                | Fig S9               |
|                                                |                                                | output/ASD_scDegEnrichment.txt                                                                                                                                                                                                                                                  | ASD_CellTypeEnrichment_SingleBarPlots.pdf                               | Fig 3C,D             |
| Comparison of ANK2 WT vs. KO IP-MS data        | ASD_ANK2_WTvsKO_Analysis.r                     | ANK2_WTvsMUT/ANK2-WT.pep1.bait2.MinImp.GenoppiStats.txt                                                                                                                                                                                                                         | ASD_ANK2_WTvsKO_Plots.pdf                                               | Fig S10B             |
|                                                |                                                | ANK2_WTvsMUT/ANK2-MUT.pep1.bait2.MinImp.GenoppiStats.txt                                                                                                                                                                                                                        | ASD_ANK2_WTvsKO_CellularComponentEnrichment.txt                         | Table S7             |
|                                                |                                                | ANK2_WTvsMUT/ANK2-WTvsMUT.pep1.bait2.MinImp.GenoppiStats.txt                                                                                                                                                                                                                    |                                                                         |                      |
| Analysis of IGF2BP1-3 targets                  | MAGMA/ASD_IGF2BP_MAGMA_1_GeneAnnot.sh          | scripts/MAGMA/ASD_IGF2BP_MAGMA_1_GeneAnnot.param                                                                                                                                                                                                                                | (merged/reformatted: data/ASD_IGF2BPtargets_MagmaResults.txt)           | Table S8             |
|                                                | MAGMA/ASD_IGF2BP_MAGMA_2_GeneAndSetAnalysis.sh | scripts/MAGMA/ASD_IGF2BP_MAGMA_2_GeneAndSetAnalysis.param                                                                                                                                                                                                                       |                                                                         |                      |
|                                                |                                                | Huang2018_IGF2BP1-3_RNAtargets.txt                                                                                                                                                                                                                                              |                                                                         |                      |
|                                                |                                                | Ensembl_BioMart_GRCh37.gene.loc                                                                                                                                                                                                                                                 |                                                                         |                      |
|                                                |                                                | (reference data downloaded from [here](https://ctg.cncr.nl/software/MAGMA/ref_data/g1000_eur.zip))                                                                                                                                                                              |                                                                         |                      |
|                                                |                                                | (PGC GWAS summary statistics downloaded from [here](https://www.med.unc.edu/pgc/download-results))                                                                                                                                                                              |                                                                         |                      |
|                                                |                                                | (Height GWAS summary statistics downlaoded from [here](https://portals.broadinstitute.org/collaboration/giant/index.php/GIANT_consortium_data_files))                                                                                                                           |                                                                         |                      |
|                                                | ASD_IGF2BP1-3_Analysis.r                       | Satterstrom2020_TableS2_Autosomal.txt                                                                                                                                                                                                                                           | ASD_IGF2BPtargets-ASDgenes_OverlapEnrichment.txt                        | Table S8             |
|                                                |                                                | ASD_MasterInteractorTable.txt                                                                                                                                                                                                                                                   | ASD_IGF2BPtargets-ASDgenes_OverlapEnrichmentPlot.pdf                    | Fig 6A,B             |
|                                                |                                                | Huang2018_IGF2BP1-3_RNAtargets.txt                                                                                                                                                                                                                                              | ASD_IGF2BPtargets-Networks_OverlapEnrichment.txt                        | Table S8             |
|                                                |                                                | ASD_IGF2BPtargets_MagmaResults.txt                                                                                                                                                                                                                                              | ASD_IGF2BPtargets-Networks_OverlapEnrichmentPlot.pdf                    | Fig 6C               |
| Rare variant and pLI score enrichment analysis | ASD_RareVariantAnalysis.r                      | Satterstrom2020_TableS2_Autosomal.txt                                                                                                                                                                                                                                           | ASD_RareVariantEnrichment.txt                                           | Table S9             |
|                                                |                                                | Kaplanis2020_TableS2.txt                                                                                                                                                                                                                                                        | ASD_RareVariantEnrichment_HeatMaps.pdf                                  | Fig S11A,B           |
|                                                |                                                | Singh2022_SCHEMA_SuppTable5.csv                                                                                                                                                                                                                                                 | ASD_RareVariantEnrichment_BarPlots.pdf                                  | Fig 7A               |
|                                                |                                                | ASD_MasterInteractorTable_withInWeb.txt                                                                                                                                                                                                                                         |                                                                         |                      |
|                                                |                                                | ASD_RareVariantAnalysis.networks                                                                                                                                                                                                                                                |                                                                         |                      |
| Common variant enrichment analysis             | MAGMA/ASD_MAGMA_Conditional.sh                 | scripts/MAGMA/ASD_MAGMA_Conditional.param                                                                                                                                                                                                                                       | (merged/reformatted: data/ASD_MagmaResults.txt)                         | Table S9             |
|                                                | MAGMA/ASD_MAGMA_Global_1_GeneAnnot.sh          | scripts/MAGMA/ASD_MAGMA_Global_2_GeneAndSetAnalysis.param                                                                                                                                                                                                                       |                                                                         |                      |
|                                                | MAGMA/ASD_MAGMA_Global_2_GeneAndSetAnalysis.sh | ASD_MasterInteractorTable_withInWeb.txt                                                                                                                                                                                                                                         |                                                                         |                      |
|                                                |                                                | Ensembl_BioMart_GRCh37.gene.loc                                                                                                                                                                                                                                                 |                                                                         |                      |
|                                                |                                                | (reference data downloaded from [here](https://ctg.cncr.nl/software/MAGMA/ref_data/g1000_eur.zip))                                                                                                                                                                              |                                                                         |                      |
|                                                |                                                | (PGC GWAS summary statistics downloaded from [here](https://www.med.unc.edu/pgc/download-results))                                                                                                                                                                              |                                                                         |                      |
|                                                |                                                | (Height GWAS summary statistics downlaoded from [here](https://portals.broadinstitute.org/collaboration/giant/index.php/GIANT_consortium_data_files))                                                                                                                           |                                                                         |                      |
|                                                | ASD_plotMagmaResults.r                         | ASD_MasterInteractorTable.txt                                                                                                                                                                                                                                                   | ASD_MagmaResults_FacetHeatMap.pdf                                       | Fig S11C             |
|                                                |                                                | ASD_MagmaResults.txt                                                                                                                                                                                                                                                            |                                                                         |                      |
| Generating social Manhattan plot               | ASD_plotSocialManhattan.r                      | Satterstrom2020_TableS2_Autosomal.txt                                                                                                                                                                                                                                           | ASD_SocialManhattanPlot.pdf                                             | Fig 7B               |
|                                                |                                                | ASD_MasterInteractorTable.txt                                                                                                                                                                                                                                                   |                                                                         |                      |
|                                                |                                                | ASD_ValidationSummary.txt                                                                                                                                                                                                                                                       |

